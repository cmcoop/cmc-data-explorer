<div ng-init="initialize()" ng-cloak>  
    <div class="row">
        <div class="col-md-12" ng-show='isMonitor'>
            <h4 class="bright">
                Hi {{userName}}, welcome to the Data Edit & Review page!
            </h4>
            <p class="success">
                Here, you can review data that you uploaded for {{userGroup}}.
                The table below displays sampling events for the selected sampling location.
                Click the check-mark (✓) next to the sampling event you would like to review and the data will appear below the graph in a
                format similar to the data upload form.
                Any data in the form that has the “Uploaded” designation, means that it has not yet been verified by the {{userGroup}}'s
                Group Coordinator, so you can still review the data and correct any possible errors made when entering it.
                Make any needed edits directly to the values within the form fields and then click the Save button at the bottom of the page.
            </p>
        </div>
        <div class="col-md-12" ng-show='isCoordinator'>
            <h4 class="bright" >
                Hi {{userName}}, welcome to the Data Edit & Review page!
            </h4>
            <p class="success">
                Here you can review, edit and publish all data that has been uploaded to the Data Explorer {{userGroup}}. The table below displays sampling events for the selected sampling location. Data needs to be published in order for it to appear on the homepage of the Data Explorer.
            </p>
        </div>
        <div class="col-md-12"  ng-show='!isMonitorOrCoordinator'>
            <h4 class="bright">
                Hi {{userName}}, welcome to the Data Edit & Review page!
            </h4>
            <p class="success">
                Here you can review, edit and publish all data that has been uploaded to the Data Explorer. The table below displays sampling events for the selected sampling location. Data needs to be published in order for it to appear on the homepage of the Data Explorer.
            </p>                
        </div>
    </div>  
    <h3 ng-show="loading">Loading...</h3>
    <div ng-show="!loading">
        <div class="row">
            <div class="col-md-3" ng-hide="isMonitorOrCoordinator">
                <selectpicker data-array="groupsList" data-model="slctGroupId"></selectpicker>
                <div class="danger" ng-hide="hideNoStationForGroup">{{noStations}}</div>
                <div class="formElementInfo">Use the dropdown list to choose the group for which you will be editing data.</div>
            </div>
            <div class="col-md-3">
                <selectpicker data-array="stationsList" data-model="stationId"></selectpicker>
                <div class="danger" ng-hide="hideNoSamplesForStation">{{ isMonitor == true ? 'You have no unpublished ' : 'There are no ' }}samples for this station.</div>
                <div class="formElementInfo">Use the dropdown list to choose the sampling station for which you will be editing data.</div>
            </div>
            <div class="col-md-3">
                <span class="fa fa-spinner fa-spin" ng-show="gettingEvents"></span>
            </div>
        </div>
        <div class="row">
            <div class="verticalSpace20"></div>
            <div class="col-md-10">
                <div ui-grid="gridOptions" ui-grid-selection class="ui-grid-custom-class" ng-if="gridOptions"></div>
            </div>
            <div class="col-md-2">
                <div>
                    <label>Download</label>
                    <a ng-class="downloadClicked ? 'btn btn-default':'btn btn-success'" ng-csv="getDataForDownload()" filename="samples.csv" lazy-load="true">
                        <span ng-class="downloadClicked ? 'fa fa-spinner fa-spin':'fa fa-download'" aria-hidden="true"></span> Download Data
                    </a>

                    <div class="verticalSpace20"></div>
                </div>

                <div ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                    <label>Bulk Action</label>
                    <button type="button" class="btn btn-danger" ng-click="deleteDialogue()">
                        <span class="fa fa-remove" aria-hidden="true"></span>
                        Delete Selected
                    </button>
                    <div class="verticalSpace10"></div>
                    <button type="button" class="btn btn-success" ng-click="publishDialogue()">
                        <span class="fa fa-edit" aria-hidden="true"></span>
                        Publish Selected
                    </button>
                    <div class="verticalSpace20"></div>
                </div>
                

                <div>
                    <label>Plot Controls</label>
                    <button type="button" class="btn btn-success" ng-click="getPlot()">
                        <span class="glyphicon" ng-class="togglePlot ? 'glyphicon-eye-close' : 'glyphicon-eye-open'" aria-hidden="true"></span>
                        {{ togglePlot == true ? 'Hide' : 'Show' }} Plot
                    </button>
                </div>
                <div class="verticalSpace20"></div>
                <div ng-show="showEditEventBtn">
                    <label>Edit</label>
                    <button type="button" class="btn btn-success" ng-click="getSelectedEvent(row);">
                        <span class="fa fa-edit" aria-hidden="true"></span>
                        Edit Selected Event
                    </button>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <span class="bright" ng-show="showSelectMsg">You selected samples collected from {{editEvent.StationName}} on {{editEventDateText}}, submitted by {{editEventCreatedBy}}. </span>
            </div>
        </div>
        <div class="verticalSpace20"></div>
        <div class="row" ng-show="togglePlot">
            <div class="col-md-3">
                <span>Choose parameter to plot</span>
                <div ng-repeat-start="plotPrm in plotParameters" ng-if="$first">
                    <div class="radio">
                        <label ng-click="getPlotData(plotPrm.id)"><input type="radio" name="optradio" checked>{{plotPrm.name}}</label>
                    </div>
                </div>
                <div ng-repeat-end ng-if="!$first">
                    <div class="radio">
                        <label ng-click="getPlotData(plotPrm.id)"><input type="radio" name="optradio">{{plotPrm.name}}</label>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <canvas id="line" height="250" class="chart chart-line chart-custom-class" chart-data="plotData"
                        chart-labels="plotLabels" chart-series="plotSeries" chart-options="plotOptions"
                        chart-click="onClick"></canvas>
            </div>
        </div>
        <h3 ng-show="editEventLoading"><span class="fa fa-spinner fa-spin"></span>  Loading Selected Sampling Event...</h3>
        <div class="col-md-12">
            <form name="addSampleForm" ng-show="editEventLoadingDone">
                <div class="row">
                    <div class="col-md-3">
                        <h4>Edit Event</h4>
                    </div>
                    <div class="col-md-4 col-md-offset-5" ng-show="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                        <label>Bulk Action</label>
                        <selectpicker name="setAllPicker" data-array="qaFlagsAllList" data-model="qaFlagsAllId"
                                      title="Set All Status Dropdowns To:"></selectpicker>
                    </div>
                </div>
                <div class="row">
                    <span class="col-md-12 success">These data were orignally submitted by {{editEventCreatedBy}}, <a href="{{'mailto:' + editEventCreatedByEmail}}" target="_top"><span class="glyphicon glyphicon-envelope"></span></a></span>
                </div>
                <div class="verticalSpace20"></div>
                <div class="form-group">
                    <label>Group</label>
                    <div class="row">
                        <div class="col-md-12">{{editEvent.GroupName}}</div>
                    </div>
                </div>

                <div class="form-group" ng-class="{ 'has-error': !addSampleForm.$pristine && addSampleForm.Station.$error.required }">
                    <label>Sampling Site</label>
                    <selectpicker name="Station" data-array="stationsList" data-model="editEvent.StationId" required></selectpicker>
                    <span class="help-block" ng-show="addSampleForm.Station.$error.required && !addSampleForm.$pristine">Must Select a Station</span>
                    <div class="help-block" ng-messages="addSampleForm.Station.$error.required" ng-show="addSampleForm.Station.$touched">
                        <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                    </div>
                    <div class="danger" ng-hide="hideNoStationForGroup">{{noStations}}</div>
                    <div class="danger" ng-messages="addSampleForm.Station.$error">
                        <div ng-message="eventExistsError">
                            Sampling Event exists in database.
                            Please check that this combination of Group, Station, Sample Date, and Sample Time does not exist in the database.
                        </div>
                    </div>

                    <div class="formElementInfo">Use the dropdown list to choose the sampling station for which you will be uploading data.</div>
                </div>
                <div class="form-group" ng-class="{ 'has-error': addSampleForm.SampleDate.$touched && addSampleForm.SampleDate.$invalid }">
                    <label>Sample Date </label>
                    <input id="sampleDateInput" name="SampleDate" class="form-control" placeholder="Enter Sample Date"
                           ng-model="editEvent.SampleDate"
                           ng-model-options="{ updateOn: 'blur' }"
                           format="YYYY-MM-DD"
                           max-date="maxDateMoment"
                           moment-picker="editEvent.SampleDate"
                           required>
                    <div class="help-block" ng-messages="addSampleForm.SampleDate.$error" ng-show="addSampleForm.SampleDate.$touched">
                        <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                    </div>
                    <div class="danger" ng-messages="addSampleForm.SampleDate.$error">
                        <div ng-message="eventExistsError">
                            Sampling Event exists in database.
                            Please check that this combination of Group, Station, Sample Date, and Sample Time does not exist in the database.
                        </div>
                    </div>
                    <div class="formElementInfo">Click on text box above and use the calendar that opens to choose the sample date</div>
                </div>
                <div class="form-group" ng-class="{ 'has-error': addSampleForm.SampleTime.$touched && addSampleForm.SampleTime.$invalid }">
                    <label>Sample Time</label>
                    <input name="SampleTime" class="form-control" placeholder="Enter Sample Time"
                           moment-picker="editEvent.SampleTime"
                           format="h:mm A"
                           ng-model="dt.startDateMoment"
                           show-header=false
                           required>
                    <div class="help-block" ng-messages="addSampleForm.SampleTime.$error" ng-show="addSampleForm.SampleTime.$touched">
                        <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                    </div>
                    <div class="danger" ng-messages="addSampleForm.SampleTime.$error">
                        <div ng-message="eventExistsError">
                            Sampling Event exists in database.
                            Please check that this combination of Group, Station, Sample Date, and Sample Time does not exist in the database.
                        </div>
                    </div>
                    <div class="formElementInfo">Click on the text box above to select the sample time</div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <h4 class="bright">
                            Conditions During Sampling
                        </h4>
                        <p class="success"> Use the fields in this section to describe conditions at the sampling location at the time sampling occurred.</p>
                    </div>
                </div>
                <div class="verticalSpace20"></div>
                <div class="row">
                    <div ng-repeat="condition in conditions">
                        <div class="col-md-4" ng-if="!condition.isCategorical">
                            <label>{{condition.Name}}</label>
                            <div class="form-group" ng-class="{ 'has-error': addSampleForm[condition.Name].$touched && addSampleForm[condition.Name].$invalid }">
                                <input ng-model="editCondition[condition.Id]['Value']"
                                       name="{{condition.Name}}"
                                       class="form-control"
                                       type="text"
                                       placeholder="Enter {{condition.Name}}" />

                                <div class="help-block" ng-messages="addSampleForm[condition.Name].$error" ng-show="addSampleForm[condition.Name].$touched">
                                    <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                </div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Stream Conditions'">("Calm, Ripple, Waves, or Whitecaps")</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Stream Flow'">("High, Normal, Low, or NA")</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Water Color'">("Normal or Abnormal")</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Water Color Description'">(ex. "Clear, Brown, Green, etc")</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Weather Conditions'">(ex. "Sunny or Partly Cloudy or Overcast or Fog/Haze or Drizzle or Intermittent Rain or Rain or Snow")</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Rainfall'">(Total in mm the week prior to sampling; ex. 2.3)</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Tide State'">("High, Outgoing, Incoming, Low, NA")</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Rainfall Within 48 Hours'">(Total in mm 48 hours prior to sampling; ex. 1.2)</div>
                                <div class="formElementInfo" ng-show="condition.Name == 'Other Conditions'">(ex. "Sea Nettles or Dead Fish or Dead Crabs or SAV or Oil Slick or Ice or Debris or Erosion or Foam or Bubbles or Odor")</div>
                            </div>
                        </div>
                        <div class="col-md-4" ng-if="condition.isCategorical">
                            <label>{{condition.Name}}</label>
                            <div class="form-group">
                                <selectpicker name="{{condition.Name}}" data-array="condition.Categories" data-model="editCondition[condition.Id]['Value']" title=""></selectpicker>
                            </div>
                            <div></div>
                        </div>
                    </div>
                </div>
                <div ng-show="testNoCal == false">
                    <div class="row">
                        <div class="col-md-12">
                            <h4 class="bright">Calibration</h4>
                            <p class="success">
                                Use the fields in this section to input calibration information.
                            </p>
                        </div>
                    </div>

                    <div ng-repeat="ind in prmSetIndices">
                        <div ng-repeat="prm in parametersNoSampleDepth" ng-if="prm.isCalibrationParameter">
                            <div class="row">
                                <div class="col-md-3">
                                    <label>{{prm.Description}} ({{prm.Units}})</label>
                                </div>
                                <div class="col-md-3">
                                    <button type="button" class="btn btn-default bright" ng-show="!editSample[prm.Code + ind].dupExists && editSample[prm.Code + ind].requiresDuplicate == true" ng-click="editSample[prm.Code + ind].dupExists = true;">
                                        <span class="glyphicon glyphicon-plus-sign" aria-hidden="true" add-duplicates-button></span> Add Duplicate Sample</>
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div ng-show="editSample[prm.Code + ind]['groupParamWarning']" class="danger">Note: this parameter is not among the parameters currently associated with this group. </div>
                                </div>
                            </div>
                            <div class="verticalSpace10"></div>
                            <div class="row">
                                <div class="col-md-3 ">
                                    <div class="form-group  margin-top-5" ng-class="{ 'has-error': addSampleForm[prm.Code + ind +'_Value'].$touched && addSampleForm[prm.Code + ind +'_Value'].$invalid }">
                                        <label></label>
                                        <input ng-model="editSample[prm.Code + ind]['Value']"
                                               name="{{prm.Code + ind}}_Value"
                                               ng-change="checkValueForWarning(editSample[prm.Code + ind])"
                                               class="form-control"
                                               type="text"
                                               placeholder="Enter {{prm.Description}} ({{prm.Units}})"
                                               ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001"
                                               ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">
                                        <div class="errorText" ng-show="editSample[prm.Code + ind].warning">{{editSample[prm.Code + ind].warningText}}</div>
                                        <div class="help-block" ng-messages="addSampleForm[prm.Code + ind +'_Value'].$error" ng-show="addSampleForm[prm.Code + ind +'_Value'].$touched">
                                            <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                            <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3" ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                    <div class="form-group  margin-top-5">
                                        <label></label>
                                        <selectpicker name="{{[prm.Code + ind]['QaFlagId']}}" data-array="qaFlagsList" data-model="editSample[prm.Code + ind]['QaFlagId']" 
                                                      title="Choose Status"
                                                      >
                                        </selectpicker>
                                    </div>
                                </div>
                                <div class="col-md-3" ng-hide="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                    <div class="form-group">
                                        <label>Data Status</label>
                                        <h4 ng-show="editSample[prm.Code + ind]['QaFlagId']==1">
                                            Uploaded
                                        </h4>
                                        <h4 ng-show="editSample[prm.Code + ind]['QaFlagId']==2">
                                            Published
                                        </h4>
                                    </div>
                                </div>
                            </div>
                            <div class="duplicate" ng-show="editSample[prm.Code + ind].dupExists">
                                <!--<div class="row" ng-hide="true">
                                    <div class="col-md-4">
                                        <div class="form-group" ng-class="{ 'has-error': addSampleForm[prm.Code + ind + 'dup_Depth'].$touched && addSampleForm[prm.Code + ind + 'dup_Depth'].$invalid }">
                                            <input ng-model="editSample[prm.Code + ind+ 'dup']['Depth']"
                                                   name="{{prm.Code + ind + 'dup'}}_Depth"
                                                   class="form-control"
                                                   type="text"
                                                   placeholder="Enter Sample Depth (m)"
                                                   ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001"
                                                   >                                            
                                            <div class="help-block" ng-messages="addSampleForm[prm.Code + ind + 'dup_Depth'].$error" ng-show="addSampleForm[prm.Code + ind + 'dup_Depth'].$touched">
                                                <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                                <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>-->
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group " ng-class="{ 'has-error': addSampleForm[prm.Code + ind + 'dup_Value'].$touched && addSampleForm[prm.Code + ind +'dup_Value'].$invalid }">
                                            <label></label>
                                            <input ng-model="editSample[prm.Code + ind + 'dup']['Value']"
                                                   name="{{prm.Code + ind}}dup_Value"
                                                   ng-change="checkValueForWarning(editSample[prm.Code + ind + 'dup'])"
                                                   class="form-control"
                                                   type="text"
                                                   placeholder="Enter {{prm.Description}} ({{prm.Units}})"
                                                   ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                            <div class="errorText" ng-show="editSample[prm.Code + ind + 'dup'].warning">{{editSample[prm.Code + ind + 'dup'].warningText}}</div>
                                            <div class="help-block" ng-messages="addSampleForm[prm.Code + ind +'dup_Value'].$error" ng-show="addSampleForm[prm.Code + ind + dup +'dup_Value'].$touched">
                                                <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                                <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3" ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                        <div class="form-group">
                                            <label></label>
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['QaFlagId']}}" data-array="qaFlagsList" data-model="editSample[prm.Code + ind + 'dup']['QaFlagId']" title="Choose Status"></selectpicker>
                                        </div>
                                    </div>                                    
                                    <div class="col-md-3" ng-hide="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                        <div class="form-group  margin-top-5">
                                            <label>Data Status</label>
                                            <h4 ng-show="editSample[prm.Code + ind + 'dup']['QaFlagId']==1">
                                                Uploaded
                                            </h4>
                                            <h4 ng-show="editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                                Published
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div ng-show="testNoDepthIndependent == false">
                    <div class="row">
                        <div class="col-md-12">
                            <h4 class="bright">Surface Sample</h4>
                            <p class="success">
                                Use the fields in this section to input data that is taken at the surface (default is 0.3m)
                                <button title="Choose a different depth" type="button" data-toggle="tooltip" data-placement="bottom"
                                        onmouseenter="$(this).tooltip('show')"
                                        class="btn btn-success btn-circle btn-sm btn-upload-form" ng-hide="show_me_depth" ng-click="show_me_depth = !show_me_depth;">
                                    <i class="fa fa-plus"></i>
                                </button>

                            </p>
                            <div class="row col-md-4" ng-show="show_me_depth">
                                <label>Surface Sample Depth (m)</label>
                                <div class="form-group">
                                    <selectpicker name="surfaceDepthDrop" data-array="surfaceDepthsList" data-model="surfaceDepth" title="Choose Surface Depth"
                                                  ng-disabled="checkForPublish(-1,false)"></selectpicker>
                                </div>
                            </div>
                            <div class="row col-md-8" ng-show="checkForPublish(-1,false)&&show_me_depth">
                                <span class="danger">You cannot edit the surface sample depth because there is published surface sample data for this event. </span>
                            </div>
                            

                            <div class="danger" ng-show="testNoDepthIndependent == true">There are no depth independent parameters for this group</div>
                        </div>
                    </div>

                    <div ng-repeat="ind in [0]">
                        <div ng-repeat="prm in parametersNoSampleDepth" ng-if="!prm.isCalibrationParameter">
                            <div class="row">
                                <div class="col-md-3">
                                    <label>{{prm.Description}} ({{prm.Units}})</label>
                                </div>
                                <div class="col-md-3">
                                    <button type="button" class="btn  btn-default bright" ng-show="!editSample[prm.Code + ind].dupExists && editSample[prm.Code + ind].requiresDuplicate == true" ng-click="editSample[prm.Code + ind].dupExists = true;">
                                        <span class="glyphicon glyphicon-plus-sign" aria-hidden="true" add-duplicates-button></span> Add Duplicate Sample</>
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div ng-show="editSample[prm.Code + ind]['groupParamWarning']" class="danger">Note: this parameter is not among the parameters currently associated with this group. </div>
                                </div>
                            </div>
                            <div class="verticalSpace10"></div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group margin-top-5" ng-class="{ 'has-error': addSampleForm[prm.Code + ind +'_Value'].$touched && addSampleForm[prm.Code + ind +'_Value'].$invalid }">
                                        <label></label>
                                        <input ng-model="editSample[prm.Code + ind]['Value']"
                                               name="{{prm.Code + ind}}_Value"
                                                ng-change="checkValueForWarning(editSample[prm.Code + ind])"
                                               class="form-control"
                                               type="text"
                                               placeholder="Enter {{prm.Description}} ({{prm.Units}})"
                                               ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" 
                                               ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">
                                        <div class="errorText" ng-show="editSample[prm.Code + ind].warning">{{editSample[prm.Code + ind].warningText}}</div>
                                        <div class="help-block" ng-messages="addSampleForm[prm.Code + ind +'_Value'].$error" ng-show="addSampleForm[prm.Code + ind +'_Value'].$touched">
                                            <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                            <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group margin-top-5">
                                        <label></label>
                                        <selectpicker name="{{[prm.Code + ind]['ProblemId']}}" data-array="problemsList" data-model="editSample[prm.Code + ind]['ProblemId']" title="Choose Problem"
                                                       ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">

                                        </selectpicker>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group margin-top-5">
                                        <label></label>
                                        <selectpicker name="{{[prm.Code + ind]['QualifierId']}}" data-array="qualifiersList" data-model="editSample[prm.Code + ind]['QualifierId']" title="Choose Qualifier"
                                                      ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">

                                        </selectpicker>
                                    </div>
                                </div>
                                <div class="col-md-3" ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                    <label>Data Status</label>
                                    <div class="form-group">
                                        <selectpicker name="{{[prm.Code + ind]['QaFlagId']}}" data-array="qaFlagsList" data-model="editSample[prm.Code + ind]['QaFlagId']" title="Choose Status"></selectpicker>
                                    </div>
                                </div>
                                <div class="col-md-3" ng-hide="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                    <div class="form-group">
                                        <label>Data Status</label>
                                        <h4 ng-show="editSample[prm.Code + ind]['QaFlagId']==1">
                                            Uploaded
                                        </h4>
                                        <h4 ng-show="editSample[prm.Code + ind]['QaFlagId']==2">
                                            Published
                                        </h4>
                                    </div>
                                </div>

                            </div>
                            <div class="duplicate" ng-show="editSample[prm.Code + ind].dupExists">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group margin-top-5 " ng-class="{ 'has-error': addSampleForm[prm.Code + ind + 'dup_Value'].$touched && addSampleForm[prm.Code + ind +'dup_Value'].$invalid }">
                                            <label></label>
                                            <input ng-model="editSample[prm.Code + ind + 'dup']['Value']"
                                                    ng-change="checkValueForWarning(editSample[prm.Code + ind + 'dup'])"
                                                   name="{{prm.Code + ind}}dup_Value"
                                                   class="form-control"
                                                   type="text"
                                                   placeholder="Enter {{prm.Description}} ({{prm.Units}})"
                                                   ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001"
                                                   ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                            <div class="errorText" ng-show="editSample[prm.Code + ind + 'dup'].warning">{{editSample[prm.Code + ind + 'dup'].warningText}}</div>
                                            <div class="help-block" ng-messages="addSampleForm[prm.Code + ind +'dup_Value'].$error" ng-show="addSampleForm[prm.Code + ind + dup +'dup_Value'].$touched">
                                                <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                                <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group margin-top-5 ">
                                            <label></label>
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['ProblemId']}}" data-array="problemsList" data-model="editSample[prm.Code + ind + 'dup']['ProblemId']" title="Choose Problem"
                                                           ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">

                                            </selectpicker>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group margin-top-5">
                                            <label></label>
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['QualifierId']}}" data-array="qualifiersList" data-model="editSample[prm.Code + ind + 'dup']['QualifierId']" title="Choose Qualifier"
                                                           ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2"></selectpicker>
                                        </div>
                                    </div>
                                    <div class="col-md-3" ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                        <label>Data Status</label>
                                        <div class="form-group">
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['QaFlagId']}}" data-array="qaFlagsList" data-model="editSample[prm.Code + ind + 'dup']['QaFlagId']" title="Choose Status"></selectpicker>
                                        </div>
                                    </div>                                    
                                    <div class="col-md-3" ng-hide="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                        <div class="form-group">
                                            <label>Data Status</label>
                                            <h4 ng-show="editSample[prm.Code + ind + 'dup']['QaFlagId']==1">
                                                Uploaded
                                            </h4>
                                            <h4 ng-show="editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                                Published
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div ng-hide="noDepthProfileParameters">
                    <div class="row">
                        <div class="col-md-12">
                            <h4 class="bright">Depth Profile</h4>
                        </div>
                    </div>
                    <div ng-repeat="ind in prmSetIndices">
                        <div class="success" ng-show="ind == 0">
                            <p>
                                Use the fields in this section to enter samples.
                                You can enter data for additional depths by clicking the “Add Sample Depth” button.
                                This will add another complete set of water quality data fields (referred to as “Water Quality Sample Sets”).
                                If you do not sample all parameters each depth, please leave those fields blank.
                            </p>
                            <div class="danger" ng-show="profileDepthError">
                                Please check that for each sample depth, that has at least one value,
                                that there is also an associated sample depth. Please either delete the sample value(s) in this set or add a sample depth.
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <label>Sample Depth</label>
                                <div class="form-group" ng-class="{ 'has-error': addSampleForm[ind +'_Depth'].$touched && addSampleForm[ind +'_Depth'].$invalid }">
                                    <input ng-model="depths[ind]['Depth']"
                                           name="{{ind}}_Depth"
                                           class="form-control"
                                           type="text"
                                           placeholder="Enter Sample Depth (m)"
                                           ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" ng-disabled="checkForPublish(ind,true)">
                                    <div class="help-block" ng-messages="addSampleForm[ind +'_Depth'].$error" ng-show="addSampleForm[ind +'_Depth'].$touched">
                                        <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                        <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-repeat="prm in parameters">
                            <div class="row">
                                <div class="col-md-3">
                                    <label>{{prm.Description}} ({{prm.Units}})</label>
                                </div>
                                <div class="col-md-3">
                                    <button type="button" id="{{prm.Code + ind}}dupbtn" class="btn btn-default bright" ng-show="!editSample[prm.Code + ind].dupExists && editSample[prm.Code + ind].requiresDuplicate == true" ng-click="editSample[prm.Code + ind].dupExists = true;">
                                        <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> Add Duplicate Sample</>
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div ng-show="editSample[prm.Code + ind]['groupParamWarning']" class="danger">Note: this parameter is not among the parameters currently associated with this group. </div>
                                </div>
                            </div>
                            <div class="verticalSpace10"></div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group margin-top-5 " ng-class="{ 'has-error': addSampleForm[prm.Code + ind +'_Value'].$touched && addSampleForm[prm.Code + ind +'_Value'].$invalid }">
                                        <label></label>
                                        <input ng-model="editSample[prm.Code + ind]['Value']"
                                                ng-change="checkValueForWarning(editSample[prm.Code + ind])"
                                               name="{{prm.Code + ind}}_Value"
                                               class="form-control"
                                               type="text"
                                               placeholder="Enter {{prm.Description}} ({{prm.Units}})"
                                               ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001"
                                               ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">
                                        <div class="errorText" ng-show="editSample[prm.Code + ind].warning">{{editSample[prm.Code + ind].warningText}}</div>
                                        <div class="help-block" ng-messages="addSampleForm[prm.Code + ind +'_Value'].$error" ng-show="addSampleForm[prm.Code + ind +'_Value'].$touched">
                                            <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                            <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group margin-top-5">
                                        <label></label>
                                        <selectpicker name="{{[prm.Code + ind]['ProblemId']}}" data-array="problemsList" data-model="editSample[prm.Code + ind]['ProblemId']" title="Choose Problem"
                                                      ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">

                                        </selectpicker>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group margin-top-5">
                                        <label></label>
                                        <selectpicker name="{{[prm.Code + ind]['QualifierId']}}" data-array="qualifiersList" data-model="editSample[prm.Code + ind]['QualifierId']" title="Choose Qualifier"
                                                      ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">

                                        </selectpicker>
                                    </div>

                                </div>
                                <div class="col-md-3" ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                    <div class="form-group">
                                        <label>Data Status</label>
                                        <selectpicker name="{{[prm.Code + ind]['QaFlagId']}}" data-array="qaFlagsList" data-model="editSample[prm.Code + ind]['QaFlagId']" title="Choose Status"
                                                      ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind]['QaFlagId']==2">

                                        </selectpicker>
                                    </div>
                                </div>
                                <div class="col-md-3" ng-hide="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                    <div class="form-group">
                                        <label>Data Status</label>
                                        <h4 ng-show="editSample[prm.Code + ind ]['QaFlagId']==1">
                                            Uploaded
                                        </h4>
                                        <h4 ng-show="editSample[prm.Code + ind]['QaFlagId']==2">
                                            Published
                                        </h4>
                                    </div>
                                </div>
                            </div>
                            <div class="duplicate" ng-show="editSample[prm.Code + ind].dupExists">
                                <div class="row" ng-hide="true">
                                    <div class="col-md-3">
                                        <div class="form-group" ng-class="{ 'has-error': addSampleForm[prm.Code + ind + 'dup_Depth'].$touched && addSampleForm[prm.Code + ind + 'dup_Depth'].$invalid }">
                                            <label></label>
                                            <input ng-model="editSample[prm.Code + ind + 'dup']['Depth']"                                                   
                                                   name="{{prm.Code + ind + 'dup'}}_Depth"
                                                   class="form-control"
                                                   type="text"
                                                   placeholder="Enter Sample Depth (m)"
                                                   ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                            <div class="help-block" ng-messages="addSampleForm[prm.Code + ind + 'dup_Depth'].$error" ng-show="addSampleForm[prm.Code + ind + 'dup_Depth'].$touched">
                                                <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                                <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group " ng-class="{ 'has-error': addSampleForm[prm.Code + ind + 'dup_Value'].$touched && addSampleForm[prm.Code + ind +'dup_Value'].$invalid }">
                                            <input ng-model="editSample[prm.Code + ind + 'dup']['Value']"
                                                    ng-change="checkValueForWarning(editSample[prm.Code + ind + 'dup'])"
                                                   name="{{prm.Code + ind}}dup_Value"
                                                   class="form-control "
                                                   type="text"
                                                   placeholder="Enter {{prm.Description}} ({{prm.Units}})"
                                                   ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                            <div class="errorText" ng-show="editSample[prm.Code + ind + 'dup'].warning">{{editSample[prm.Code + ind + 'dup'].warningText}}</div>
                                            <div class="help-block" ng-messages="addSampleForm[prm.Code + ind +'dup_Value'].$error" ng-show="addSampleForm[prm.Code + ind + dup +'dup_Value'].$touched">
                                                <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                                <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['ProblemId']}}" data-array="problemsList" data-model="editSample[prm.Code + ind + 'dup']['ProblemId']" title="Choose Problem"
                                                          ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">

                                            </selectpicker>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['QualifierId']}}" data-array="qualifiersList" data-model="editSample[prm.Code + ind + 'dup']['QualifierId']" title="Choose Qualifier"
                                                          ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001" ng-disabled="(isMonitorOrCoordinator && !(isCoordinator && coordinatorHasEnhancedPriveledges))&&editSample[prm.Code + ind + 'dup']['QaFlagId']==2">

                                            </selectpicker>
                                        </div>
                                    </div>
                                    <div class="col-md-3" ng-if="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                        <div class="form-group">
                                            <selectpicker name="{{[prm.Code + ind + 'dup']['QaFlagId']}}" data-array="qaFlagsList" data-model="editSample[prm.Code + ind + 'dup']['QaFlagId']" title="Choose Status"></selectpicker>
                                        </div>
                                    </div>
                                    <div class="col-md-3" ng-hide="!isMonitorOrCoordinator || (isCoordinator && coordinatorHasEnhancedPriveledges)">
                                        <div class="form-group">                                            
                                            <h4 ng-show="editSample[prm.Code + ind + 'dup']['QaFlagId']==1">
                                                Uploaded
                                            </h4>
                                            <h4 ng-show="editSample[prm.Code + ind + 'dup']['QaFlagId']==2">
                                                Published
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-default bright" ng-click="addParameterSet()">
                        <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> Add Sample Depth
                    </button>
                </div>
                <div class="verticalSpace20"></div>
                <div class="form-group" ng-class="{ 'has-error': addSampleForm.Comments.$touched && addSampleForm.Comments.$invalid }">
                    <label>Comments</label>
                    <textarea name="Comments" rows="5" class="form-control" placeholder="Enter Comments"
                              ng-model="editEvent.Comments"
                              ng-minlength="1"
                              ng-maxlength="1000"></textarea>
                    <div class="help-block" ng-messages="addSampleForm.Comments.$error" ng-show="addSampleForm.Comments.$touched">
                        <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                    </div>
                </div>
                <div class="verticalSpace20"></div>
                <div class="row bright">
                    <div class="col-md-4">
                        <label>Volunteer Hours</label>
                        <button title="Add Volunteer and Hours" type="button" data-toggle="tooltip" data-placement="bottom"
                                onmouseenter="$(this).tooltip('show')" ng-click="addMonitorEl()"
                                class="btn btn-success btn-circle btn-sm pull-right btn-upload-form">
                            <i class="fa fa-plus"></i>
                        </button>
                    </div>
                </div>
                <div data-ng-repeat="monitor in monitors track by $index" ng-if="monitors.length>0">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <selectpicker name="{{'monitor' + $index + 'Name'}}" data-array="groupUsersList" data-model="monitor.Id" title="Choose Monitor"></selectpicker>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group " ng-class="{ 'has-error': addSampleForm['monitor' + $index + 'Hours'].$touched && addSampleForm['monitor' + $index + 'Hours'].$invalid }">
                                <input ng-model="monitor.Hours"
                                       name="{{'monitor' + $index + 'Hours'}}"
                                       class="form-control"
                                       type="text"
                                       placeholder="Enter Monitoring Hours for selected User"
                                       ng-pattern="/^-?[0-9]\d*(\.\d+)?$/" step="0.00001">
                                <div class="help-block" ng-messages="addSampleForm['monitor' + $index + 'Hours'].$error" ng-show="addSampleForm['monitor' + $index + 'Hours'].$touched">
                                    <p ng-message="pattern">Must be a valid decimal (ex. 1, -76.0646, 0.2353).</p>
                                    <div ng-messages-include="../../ang/admin/helpers/validationMessages.html"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <button type="button" class="btn btn-danger" ng-click="clearMonitor(monitor)">
                                <i class="fa fa-remove"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="verticalSpace20"></div>
                <button type="button" class="btn btn-success" ng-click="addSamples(addSampleForm)">
                    <span class="glyphicon glyphicon-check" aria-hidden="true"></span> Save
                </button>

            </form>
        </div>
        <div class="modal " id="deleteModal" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Delete?</h3>
                    </div>
                    <div class="modal-body">
                        <span ng-if="nEventsToDelete == 1">Are you sure you want to delete this sampling event and all associated samples?</span>
                        <span ng-if="nEventsToDelete > 1">Are you sure you want to delete {{nEventsToDelete}} sampling events and all associated samples?</span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" ng-click="deleteSelected()">
                            <span class="glyphicon glyphicon-check" aria-hidden="true"></span> Yes
                        </button>
                        <button type="button" class="btn btn-danger" data-dismiss="modal">
                            <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> No
                        </button>
                    </div>
                </div>
            </div>
        </div><!-- /.modal -->
        <div class="modal " id="publishModal" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Publish?</h3>
                    </div>
                    <div class="modal-body">
                        <span ng-if="nEventsToPublish == 1">Are you sure you want to publish this sampling event and all associated samples?</span>
                        <span ng-if="nEventsToPublish > 1">Are you sure you want to publish {{nEventsToPublish}} sampling events and all associated samples?</span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" ng-click="publishSelected(true);togglePublishBtn = !togglePublishBtn;" >
                            <span class="" ng-class="togglePublishBtn ? 'fa fa-spinner fa-spin ' : 'glyphicon glyphicon-check'" aria-hidden="true"></span> Yes
                        </button>
                        <button type="button" class="btn btn-danger" data-dismiss="modal">
                            <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> No
                        </button>
                    </div>
                </div>
            </div>
        </div><!-- /.modal -->
        <div class="modal " id="warningsModal" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div ui-view="warnings"></div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal --->
        <div class="modal " id="noSamplesModal" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">No Water Quality Samples</h4>
                    </div>
                    <div class="modal-body" novalidate>
                        <p>
                            The form you submitted does not include any water quality samples. Would you like to proceed with the save?
                        </p>
                        
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" ng-click="confirmNoSamples()" data-dismiss="modal">
                            <span class="glyphicon glyphicon-check" aria-hidden="true"></span> Proceed with Upload
                        </button>
                        <button type="button" class="btn btn-danger" ng-click="" data-dismiss="modal">
                            <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> Cancel
                        </button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal --->
        <div class="modal " id="warningsPublishedModal" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div ui-view="warningsPublished"></div>
                   
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal --->

    </div>
</div>
